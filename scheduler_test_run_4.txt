<frozen runpy>:128: RuntimeWarning: 'app.services.scheduler' found in sys.modules after import of package 'app.services', but prior to execution of 'app.services.scheduler'; this may result in unpredictable behaviour
2025-11-29 21:25:53 [info     ] Starting pipeline job
2025-11-29 21:25:53 [info     ] Fetching upcoming matches
2025-11-29 21:25:54 [info     ] Fetched 306 fixtures for Bundesliga
2025-11-29 21:25:54 [info     ] Fetching match odds (Over/Under 2.5 and BTTS)
2025-11-29 21:25:55 [info     ] Fetched 12 events for Bundesliga (soccer_germany_bundesliga)
2025-11-29 21:25:55 [debug    ] Odds API Event: Hamburger SV vs VfB Stuttgart -> Hamburger SV vs VfB Stuttgart
2025-11-29 21:25:55 [info     ] Found 1 matches for Hamburger SV vs VfB Stuttgart
2025-11-29 21:25:55 [warning  ] No Over 2.5 odds found for Hamburger SV vs VfB Stuttgart
2025-11-29 21:25:55 [debug    ] Odds API Event: Eintracht Frankfurt vs VfL Wolfsburg -> Eintracht Frankfurt vs VfL Wolfsburg
2025-11-29 21:25:55 [info     ] Found 1 matches for Eintracht Frankfurt vs VfL Wolfsburg
2025-11-29 21:25:55 [warning  ] No Over 2.5 odds found for Eintracht Frankfurt vs VfL Wolfsburg
2025-11-29 21:25:55 [debug    ] Odds API Event: SC Freiburg vs FSV Mainz 05 -> SC Freiburg vs FSV Mainz 05
2025-11-29 21:25:55 [info     ] Found 1 matches for SC Freiburg vs FSV Mainz 05
2025-11-29 21:25:56 [warning  ] No Over 2.5 odds found for SC Freiburg vs FSV Mainz 05
2025-11-29 21:25:56 [debug    ] Odds API Event: FSV Mainz 05 vs Borussia Monchengladbach -> FSV Mainz 05 vs Borussia Mönchengladbach
2025-11-29 21:25:56 [info     ] Found 1 matches for FSV Mainz 05 vs Borussia Mönchengladbach
2025-11-29 21:25:56 [warning  ] No Over 2.5 odds found for FSV Mainz 05 vs Borussia Mönchengladbach
2025-11-29 21:25:56 [debug    ] Odds API Event: 1. FC Heidenheim vs SC Freiburg -> 1. FC Heidenheim vs SC Freiburg
2025-11-29 21:25:56 [info     ] Found 1 matches for 1. FC Heidenheim vs SC Freiburg
2025-11-29 21:25:56 [warning  ] No Over 2.5 odds found for 1. FC Heidenheim vs SC Freiburg
2025-11-29 21:25:56 [debug    ] Odds API Event: 1. FC Köln vs FC St. Pauli -> 1. FC Köln vs FC St. Pauli
2025-11-29 21:25:56 [info     ] Found 1 matches for 1. FC Köln vs FC St. Pauli
2025-11-29 21:25:57 [warning  ] No Over 2.5 odds found for 1. FC Köln vs FC St. Pauli
2025-11-29 21:25:57 [debug    ] Odds API Event: Augsburg vs Bayer Leverkusen -> FC Augsburg vs Bayer Leverkusen
2025-11-29 21:25:57 [info     ] Found 1 matches for FC Augsburg vs Bayer Leverkusen
2025-11-29 21:25:57 [warning  ] No Over 2.5 odds found for FC Augsburg vs Bayer Leverkusen
2025-11-29 21:25:57 [debug    ] Odds API Event: VfB Stuttgart vs Bayern Munich -> VfB Stuttgart vs Bayern München
2025-11-29 21:25:57 [info     ] Found 1 matches for VfB Stuttgart vs Bayern München
2025-11-29 21:25:58 [warning  ] No Over 2.5 odds found for VfB Stuttgart vs Bayern München
2025-11-29 21:25:58 [debug    ] Odds API Event: VfL Wolfsburg vs Union Berlin -> VfL Wolfsburg vs Union Berlin
2025-11-29 21:25:58 [info     ] Found 1 matches for VfL Wolfsburg vs Union Berlin
2025-11-29 21:25:58 [warning  ] No Over 2.5 odds found for VfL Wolfsburg vs Union Berlin
2025-11-29 21:25:58 [debug    ] Odds API Event: RB Leipzig vs Eintracht Frankfurt -> RB Leipzig vs Eintracht Frankfurt
2025-11-29 21:25:58 [info     ] Found 1 matches for RB Leipzig vs Eintracht Frankfurt
2025-11-29 21:25:59 [warning  ] No Over 2.5 odds found for RB Leipzig vs Eintracht Frankfurt
2025-11-29 21:25:59 [debug    ] Odds API Event: Hamburger SV vs Werder Bremen -> Hamburger SV vs Werder Bremen
2025-11-29 21:25:59 [info     ] Found 1 matches for Hamburger SV vs Werder Bremen
2025-11-29 21:25:59 [warning  ] No Over 2.5 odds found for Hamburger SV vs Werder Bremen
2025-11-29 21:25:59 [debug    ] Odds API Event: Borussia Dortmund vs TSG Hoffenheim -> Borussia Dortmund vs TSG Hoffenheim
2025-11-29 21:25:59 [warning  ] No match found for Borussia Dortmund vs TSG Hoffenheim
2025-11-29 21:25:59 [info     ] Generating player prop predictions
2025-11-29 21:25:59 [info     ] Found 0 prop lines to process
2025-11-29 21:25:59 [info     ] Generating match-level predictions
2025-11-29 21:25:59 [info     ] Found 206 upcoming matches
2025-11-29 21:25:59 [info     ] Loading match data from database
2025-11-29 21:25:59 [info     ] Loaded 5886 match records from database
2025-11-29 21:25:59 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:26:08 [info     ] Engineering BTTS features
2025-11-29 21:26:16 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
2025-11-29 21:26:16 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:26:24 [info     ] Engineering BTTS features
2025-11-29 21:26:32 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
2025-11-29 21:26:32 [warning  ] Poisson prediction failed: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- implied_prob_over_2_5
- implied_prob_under_2_5
Feature names seen at fit time, yet now missing:
- odds_btts_no
- odds_btts_yes

[LightGBM] [Fatal] The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:26:32 [warning  ] LightGBM prediction failed: The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:26:32 [warning  ] Poisson BTTS prediction failed: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- away_conceded_away_venue_avg_last_5
- away_conceded_ema_10
- away_form_avg_last_5
- away_goals_away_venue_avg_last_5
- away_goals_ema_10
- ...

2025-11-29 21:26:32 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:26:40 [info     ] Engineering BTTS features
2025-11-29 21:26:48 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
2025-11-29 21:26:48 [warning  ] Poisson prediction failed: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- implied_prob_over_2_5
- implied_prob_under_2_5
Feature names seen at fit time, yet now missing:
- odds_btts_no
- odds_btts_yes

[LightGBM] [Fatal] The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:26:48 [warning  ] LightGBM prediction failed: The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:26:48 [warning  ] Poisson BTTS prediction failed: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- away_conceded_away_venue_avg_last_5
- away_conceded_ema_10
- away_form_avg_last_5
- away_goals_away_venue_avg_last_5
- away_goals_ema_10
- ...

/Users/yannick.westermann/Desktop/Coden/proprediction/app/features/pipeline.py:393: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  combined_df = pd.concat([historical_df, current_match_df], ignore_index=True)
2025-11-29 21:26:48 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:26:56 [info     ] Engineering BTTS features
2025-11-29 21:27:04 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
[LightGBM] [Fatal] The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:04 [warning  ] LightGBM prediction failed: The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:04 [warning  ] Poisson BTTS prediction failed: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- away_conceded_away_venue_avg_last_5
- away_conceded_ema_10
- away_form_avg_last_5
- away_goals_away_venue_avg_last_5
- away_goals_ema_10
- ...

2025-11-29 21:27:04 [debug    ] Skipping match 1899 Hoffenheim vs FC Augsburg: No odds available
2025-11-29 21:27:04 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:27:12 [info     ] Engineering BTTS features
2025-11-29 21:27:22 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
2025-11-29 21:27:22 [warning  ] Poisson prediction failed: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- implied_prob_over_2_5
- implied_prob_under_2_5
Feature names seen at fit time, yet now missing:
- odds_btts_no
- odds_btts_yes

[LightGBM] [Fatal] The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:22 [warning  ] LightGBM prediction failed: The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:22 [warning  ] Poisson BTTS prediction failed: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- away_conceded_away_venue_avg_last_5
- away_conceded_ema_10
- away_form_avg_last_5
- away_goals_away_venue_avg_last_5
- away_goals_ema_10
- ...

2025-11-29 21:27:22 [info     ] Engineering Over/Under 2.5 features
2025-11-29 21:27:30 [info     ] Engineering BTTS features
2025-11-29 21:27:38 [info     ] DEBUG: engineer_btts_features - Found features: ['away_conceded_away_venue_avg_last_5', 'away_conceded_ema_10', 'away_form_avg_last_5']
2025-11-29 21:27:38 [warning  ] Poisson prediction failed: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- implied_prob_over_2_5
- implied_prob_under_2_5
Feature names seen at fit time, yet now missing:
- odds_btts_no
- odds_btts_yes

[LightGBM] [Fatal] The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:38 [warning  ] LightGBM prediction failed: The number of features in data (21) is not the same as it was in training data (39).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-11-29 21:27:38 [warning  ] Poisson BTTS prediction failed: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- away_conceded_away_venue_avg_last_5
- away_conceded_ema_10
- away_form_avg_last_5
- away_goals_away_venue_avg_last_5
- away_goals_ema_10
- ...

2025-11-29 21:27:38 [debug    ] Skipping match Borussia Dortmund vs 1899 Hoffenheim: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Union Berlin vs RB Leipzig: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Borussia Mönchengladbach vs VfL Wolfsburg: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match 1899 Hoffenheim vs Hamburger SV: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Eintracht Frankfurt vs FC Augsburg: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match FC St. Pauli vs 1. FC Heidenheim: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Bayer Leverkusen vs 1. FC Köln: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match SC Freiburg vs Borussia Dortmund: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Bayern München vs FSV Mainz 05: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Werder Bremen vs VfB Stuttgart: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match Borussia Dortmund vs Borussia Mönchengladbach: No odds available
2025-11-29 21:27:38 [debug    ] Skipping match VfL Wolfsburg vs SC Freiburg: No odds available
2025-11-29 21:27:38 [info     ] Engineering Over/Under 2.5 features
